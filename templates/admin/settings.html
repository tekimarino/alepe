{% extends "base.html" %}
{% set title = "Paramètres" %}
{% block content %}
  <h1>Paramètres</h1>

  <div class="card narrow">
    <form class="form" method="post">
      <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">

      <label>Taux de paie agent (F CFA / personne)</label>
      <input type="number" min="0" name="pay_rate" value="{{ settings.pay_rate if settings.pay_rate is not none else 500 }}">
      <div class="hint">Par défaut : 500 F CFA.</div>

      <label style="margin-top:12px;"><input type="checkbox" name="double_approval" value="1" {% if settings.double_approval %}checked{% endif %}> Double validation (superviseur → admin)</label>
      <div class="hint">Si activé : le superviseur met « Vérifié » et l’admin doit « Approuver ».</div>

      <div class="actions" style="margin-top:12px;">
        <button class="btn primary" type="submit">Enregistrer</button>
        <a class="btn" href="{{ url_for('admin_dashboard') }}">Retour</a>
      </div>
    </form>
  </div>

  <div class="card narrow" style="margin-top:16px; border:1px solid rgba(220,38,38,.25);">
    <form class="form" method="post" action="{{ url_for('admin_reset_data') }}"
          onsubmit="return confirm('Attention : cette action va supprimer des données. Une sauvegarde sera créée automatiquement. Continuer ?');">
      <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">

      <h2 style="margin:0 0 6px 0;">Réinitialisation</h2>
      <div class="hint">Met à zéro certaines listes (utile avant une nouvelle campagne). <b>Une sauvegarde ZIP est créée automatiquement</b> dans le dossier <code>backups/</code>.</div>

      <label style="margin-top:12px;"><input type="checkbox" name="reset_registrations" value="1" checked> Liste des recensés</label>
      <label><input type="checkbox" name="reset_payroll" value="1" checked> Paiements / avances</label>
      <label><input type="checkbox" name="reset_agents" value="1" checked> Agents recenseurs</label>
      <label><input type="checkbox" name="reset_supervisors" value="1" checked> Superviseurs</label>

      <label style="margin-top:12px;">Confirmation</label>
      <input name="confirm_text" placeholder="Tapez RESET" required>
      <div class="hint">Pour éviter un clic accidentel, vous devez taper <b>RESET</b>.</div>

      <div class="actions" style="margin-top:12px;">
        <button class="btn danger" type="submit">Mettre à zéro</button>
      </div>
    </form>
  </div>
{% endblock %}
